import java.awt.*;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.*;
import java.time.LocalDate;
import java.time.Period;
import java.time.temporal.ChronoUnit;

public class UlangTahun extends JFrame {
    final private Font mainFont = new Font("Montserrat", Font.BOLD, 15);
    JComboBox<Integer> cbHari, cbBulan, cbTahun;
    JLabel lblUmur, lblUlangTahunSelanjutnya;

    public void initialize() {
        //Panel Input
        Integer[] hari = new Integer[31];
        for (int i = 1; i <= 31; i++) hari[i - 1] = i;
        cbHari = new JComboBox<>(hari);
        styleComboBox(cbHari);

        Integer[] bulan = new Integer[12];
        for (int i = 1; i <= 12; i++) bulan[i - 1] = i;
        cbBulan = new JComboBox<>(bulan);
        styleComboBox(cbBulan);

        Integer tahunsekarang = LocalDate.now().getYear();
        Integer[] tahun = new Integer[101];
        for (int i = 0; i < 101; i++) tahun[i] = tahunsekarang - i;
        cbTahun = new JComboBox<>(tahun);
        styleComboBox(cbTahun);

        JPanel panelInput = new JPanel();
        panelInput.setLayout(new GridLayout(1, 3, 10, 10));
        panelInput.setBackground(new Color(35, 32, 42));  
        panelInput.add(createLabeledPanel("Hari:", cbHari));
        panelInput.add(createLabeledPanel("Bulan:", cbBulan));
        panelInput.add(createLabeledPanel("Tahun:", cbTahun));

        lblUmur = new JLabel();
        lblUmur.setFont(mainFont);
        lblUmur.setHorizontalAlignment(SwingConstants.CENTER);
        lblUmur.setForeground(Color.WHITE);

        lblUlangTahunSelanjutnya = new JLabel();
        lblUlangTahunSelanjutnya.setFont(mainFont);
        lblUlangTahunSelanjutnya.setHorizontalAlignment(SwingConstants.CENTER);
        lblUlangTahunSelanjutnya.setForeground(Color.WHITE);

        JPanel outputPanel = new JPanel(new GridLayout(2, 1));
        outputPanel.add(lblUmur);
        outputPanel.add(lblUlangTahunSelanjutnya);
        outputPanel.setBackground(new Color(107, 35, 142));  
        outputPanel.setBorder(BorderFactory.createEmptyBorder(20, 20, 20, 20));

        //Panel Tombol
        JButton btnCalculate = new JButton("HITUNG USIA");
        styleButton(btnCalculate);
        btnCalculate.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                calculateUmur();
            }
        });

        JButton btnReset = new JButton("ULANGI");
        styleButton(btnReset);
        btnReset.addActionListener(new ActionListener() {
            @Override
            public void actionPerformed(ActionEvent e) {
                cbHari.setSelectedIndex(0);
                cbBulan.setSelectedIndex(0);
                cbTahun.setSelectedIndex(0);
                lblUmur.setText("");
                lblUlangTahunSelanjutnya.setText("");
            }
        });

        JPanel buttonPanel = new JPanel(new GridLayout(1, 2, 10, 10));
        buttonPanel.setBackground(new Color(35, 32, 42)); 
        buttonPanel.add(btnReset);
        buttonPanel.add(btnCalculate);

        //Panel Utama
        JPanel mainPanel = new JPanel(new BorderLayout(20, 20));
        mainPanel.setBackground(new Color(35, 32, 42)); 
        mainPanel.setBorder(BorderFactory.createEmptyBorder(25, 25, 25, 25));
        mainPanel.add(panelInput, BorderLayout.NORTH);
        mainPanel.add(outputPanel, BorderLayout.CENTER);
        mainPanel.add(buttonPanel, BorderLayout.SOUTH);

        add(mainPanel);

        setTitle("Kalkulator Usia");
        setSize(600, 400);
        setMinimumSize(new Dimension(600, 400));
        setDefaultCloseOperation(WindowConstants.EXIT_ON_CLOSE);
        setVisible(true);
    }

    private JPanel createLabeledPanel(String label, JComponent component) {
        JLabel lbl = new JLabel(label);
        lbl.setFont(mainFont);
        lbl.setForeground(Color.WHITE);
        JPanel panel = new JPanel(new BorderLayout());
        panel.add(lbl, BorderLayout.NORTH);
        panel.add(component, BorderLayout.CENTER);
        panel.setBackground(new Color(35, 32, 42));  
        return panel;
    }

    private void styleComboBox(JComboBox<Integer> comboBox) {
        comboBox.setFont(mainFont);
        comboBox.setBackground(new Color(189, 27, 106));  
        comboBox.setForeground(Color.WHITE);
        comboBox.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
    }

    private void styleButton(JButton button) {
        button.setFont(mainFont);
        button.setBackground(new Color(189, 27, 106)); 
        button.setForeground(Color.WHITE);
        button.setFocusPainted(false);
        button.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));
    }

    private void calculateUmur() {
        int hari = (Integer) cbHari.getSelectedItem();
        int bulan = (Integer) cbBulan.getSelectedItem();
        int tahun = (Integer) cbTahun.getSelectedItem();
        
        LocalDate birthDate = LocalDate.of(tahun, bulan, hari);
        LocalDate currentDate = LocalDate.now();

        if (birthDate.isAfter(currentDate)) {
            JOptionPane.showMessageDialog(null, "Tanggal lahir tidak bisa di masa depan", "Error", JOptionPane.ERROR_MESSAGE);
            return;
        }

        Period umur = Period.between(birthDate, currentDate);
        lblUmur.setText("Usia Anda: " + umur.getYears() + " tahun, " + umur.getMonths() + " bulan, " + umur.getDays() + " hari");

        LocalDate Ulangtahunselanjutnya = birthDate.withYear(currentDate.getYear());
        if (Ulangtahunselanjutnya.isBefore(currentDate) || Ulangtahunselanjutnya.isEqual(currentDate)) {
            Ulangtahunselanjutnya = Ulangtahunselanjutnya.plusYears(1);
        }

        long harisampaiulangtahunselanjutnya = ChronoUnit.DAYS.between(currentDate, Ulangtahunselanjutnya);
        lblUlangTahunSelanjutnya.setText("Ulang tahun berikutnya: " + harisampaiulangtahunselanjutnya + " hari lagi.");
    }

    public static void main(String[] args) {
        UlangTahun calculator = new UlangTahun();
        calculator.initialize();
}
}
